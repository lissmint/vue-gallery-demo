(function(e){function t(t){for(var r,o,s=t[0],l=t[1],u=t[2],d=0,f=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&f.push(n[o][0]),n[o]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);c&&c(t);while(f.length)f.shift()();return i.push.apply(i,u||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],r=!0,s=1;s<a.length;s++){var l=a[s];0!==n[l]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=a[0]))}return e}var r={},n={app:0},i=[];function o(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=r,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(a,r,function(t){return e[t]}.bind(null,r));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/vue-gallery-demo/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var c=l;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"095a":function(e,t,a){"use strict";a("f7c8")},"4efd":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var r=a("2b0e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"},on:{dragenter:function(t){t.preventDefault(),e.dragActive=!0},drop:function(t){t.preventDefault(),e.dragActive=!1},dragover:function(e){e.preventDefault()},dragleave:function(e){e.preventDefault()}}},[a("div",{attrs:{id:"container"}},[a("div",{staticClass:"app__header"},[a("h1",[e._v("Vue.js Image Gallery")]),e.imgs.length>1?a("button",{staticClass:"btn--red",on:{click:e.clear}},[e._v("Очистить")]):e._e()]),a("img-upload",{attrs:{"drag-active":e.dragActive},on:{newImage:e.addImage,addImages:e.addImages,drop:function(e){e.preventDefault()},dragover:function(e){e.preventDefault()},dragleave:function(e){e.preventDefault()}}}),a("div",{attrs:{id:"divider"}}),a("gallery",{attrs:{imgs:e.imgs},on:{removeImage:e.removeImage,drop:function(e){e.preventDefault()},dragover:function(e){e.preventDefault()},dragleave:function(e){e.preventDefault()}}})],1)])},i=[],o=(a("99af"),a("a434"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"img-upload"},[e.dragActive?a("drag-n-drop",{on:{filesAdded:function(t){return e.$emit("addImages",t)}}}):[a("div",{staticClass:"img-upload__header"},[a("div",{staticClass:"img-upload__header--option",class:{active:!e.fileUpload},on:{click:function(t){e.fileUpload=!1}}},[e._v("По ссылке")]),a("div",{staticClass:"img-upload__header--option",class:{active:e.fileUpload},on:{click:function(t){e.fileUpload=!0}}},[e._v("Из файла")])]),e.fileUpload?a("div",{staticClass:"img-upload__form--file"},[a("form",[a("div",{staticClass:"img-upload__message",class:{error:e.error,success:e.success}},[e._v(e._s(e.uploadMsg))]),a("label",[e._v("Загрузить"),a("input",{attrs:{type:"file"},on:{change:e.addImagesFromFile}})])])]):a("div",{staticClass:"img-upload__form--link"},[a("form",{on:{submit:function(t){return t.preventDefault(),e.addImage(t)}}},[a("div",{staticClass:"img-upload__message",class:{error:e.error,success:e.success}},[e._v(e._s(e.uploadMsg))]),a("div",{staticClass:"img-upload__form-row"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.url,expression:"url"}],attrs:{type:"text",placeholder:"Ссылка"},domProps:{value:e.url},on:{input:function(t){t.target.composing||(e.url=t.target.value)}}}),a("button",{attrs:{type:"submit",disabled:!e.url}},[e._v("Загрузить")])])])])]],2)}),s=[],l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dnd",class:{active:e.active},on:{dragenter:function(t){t.preventDefault(),e.active=!0},dragover:function(t){t.preventDefault(),e.active=!0},dragleave:function(t){t.preventDefault(),e.active=!1},drop:function(t){return t.preventDefault(),e.handleDrop(t)}}},[a("h5",[e._v("Отпустите, чтобы загрузить изображение")])])},u=[],c=(a("159b"),a("caad"),a("2532"),{name:"DragNDrop",data:function(){return{active:!1,toAdd:[]}},methods:{handleDrop:function(e){e.stopPropagation();var t=e.dataTransfer,a=t.files;this.handleFiles(a)},handleFiles:function(e){var t=this,a=[];e.forEach((function(e){e.type.includes("image")&&a.push(e)})),[].concat(a).forEach(this.uploadFile);var r=setInterval((function(){t.toAdd.length===a.length&&(t.$emit("filesAdded",t.toAdd),clearInterval(r))}),100)},uploadFile:function(e){var t=this,a=new FileReader;a.onloadend=function(){var e=new Image;e.onload=function(e){var r=e.target.width,n=e.target.height;t.toAdd.push({url:a.result,width:r,height:n})},e.src=a.result},a.readAsDataURL(e)}}}),d=c,f=(a("e078"),a("2877")),g=Object(f["a"])(d,l,u,!1,null,"7d823eef",null),p=g.exports,m={name:"ImgUpload",components:{DragNDrop:p},props:{dragActive:{type:Boolean,default:!1}},data:function(){return{fileUpload:!1,url:"",uploadMsg:"Введите ссылку или перетащите файл",error:!1,success:!1}},watch:{url:function(){this.error=!1,this.success=!1,this.uploadMsg="Введите ссылку или перетащите файл"},fileUpload:function(e){this.error=!1,this.success=!1,this.uploadMsg=e?"Загрузите файл в формате JSON, содержащий список изображений":"Введите ссылку или перетащите файл"}},methods:{addImage:function(){var e=this;if(this.url){var t=/[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)?/gi;if(t.test(this.url)){var a=/(https?:\/\/.*\.(?:png|jpg|jpeg|svg|gif))/.test(this.url);if(a){var r=new Image;r.onload=function(t){var a=t.target.width,r=t.target.height;e.$emit("newImage",{url:e.url,width:a,height:r}),e.error=!1,e.success=!0,e.uploadMsg="Изображение добавлено"},r.src=this.url}else this.error=!0,this.uploadMsg="Необходимо ввести ссылку на изображение"}else this.error=!0,this.uploadMsg="Ссылка не прошла проверку"}else this.error=!0,this.uploadMsg="Введите ссылку или перетащите файл"},addImagesFromFile:function(e){var t=this,a=new FileReader,r=e.target.files;a.onloadend=function(){try{var r=a.result,n=JSON.parse(r);n&&t.$emit("addImages",n.galleryImages)}catch(e){t.error=!0,t.uploadMsg="Ошибка при загрузке файла"}},a.readAsText(r[0])}}},v=m,h=(a("095a"),Object(f["a"])(v,o,s,!1,null,"2a758ec2",null)),_=h.exports,y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"gallery"},e._l(e.imgs,(function(t,r){return a("div",{key:r,staticClass:"gallery__img",class:{full:r%3===0}},[a("div",{staticClass:"gallery__img--remove"},[a("img",{attrs:{src:"/images/delete.svg"},on:{click:function(t){return e.$emit("removeImage",r)}}})]),a("gallery-image",{attrs:{img:t,full:r%3===0}})],1)})),0)},b=[],I=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("img",{style:"opacity: "+(e.loaded?1:0),attrs:{loading:"lazy",src:e.img.url,alt:"gallery-image",height:"500"},on:{loadend:function(t){e.loaded=!0,e.$emit("loaded")}}})},w=[],D={name:"GalleryImage",props:{img:{type:Object,default:function(){},required:!0},full:{type:Boolean,default:!0}},data:function(){return{loaded:!1}}},O=D,A=Object(f["a"])(O,I,w,!1,null,"6d6d9ea7",null),j=A.exports,C={name:"Gallery",components:{GalleryImage:j},props:{imgs:{type:Array,default:function(){return[]}}}},M=C,x=(a("5c9e"),Object(f["a"])(M,y,b,!1,null,"926d5afe",null)),S=x.exports,$={name:"App",components:{DragNDrop:p,Gallery:S,ImgUpload:_},data:function(){return{imgs:[],dragActive:!1}},beforeMount:function(){var e=localStorage.getItem("imgs");e&&(this.imgs=JSON.parse(e))},methods:{addImage:function(e){this.imgs.unshift(e),this.saveImages()},addImages:function(e){this.imgs=e.concat(this.imgs),this.dragActive=!1,this.saveImages()},removeImage:function(e){this.imgs.splice(e,1),this.saveImages()},saveImages:function(){localStorage.setItem("imgs",JSON.stringify(this.imgs))},clear:function(){this.imgs=[],localStorage.removeItem("imgs")}}},F=$,U=(a("7faf"),Object(f["a"])(F,n,i,!1,null,null,null)),k=U.exports;r["a"].config.productionTip=!1,new r["a"]({render:function(e){return e(k)}}).$mount("#app")},"5c9e":function(e,t,a){"use strict";a("68e0")},"68e0":function(e,t,a){},"7faf":function(e,t,a){"use strict";a("b8ff")},b8ff:function(e,t,a){},e078:function(e,t,a){"use strict";a("4efd")},f7c8:function(e,t,a){}});
//# sourceMappingURL=app.7793b831.js.map